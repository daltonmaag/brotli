language:
- objective-c
env:
  matrix:
  - INSTALL_TYPE='system' VERSION=2.7
  - INSTALL_TYPE='macpython' VERSION=2.7.10 CC=clang CXX=clang++
  - INSTALL_TYPE='macpython' VERSION=3.4.3 CC=clang CXX=clang++
  - INSTALL_TYPE='homebrew' VERSION=2.7.10
  - INSTALL_TYPE='homebrew' VERSION=3.4.3
install:
- source terryfy/travis_tools.sh
- get_python_environment $INSTALL_TYPE $VERSION venv
- pip install --upgrade wheel
script:
- python setup.py build_ext test
after_success:
- pip wheel -w dist .
before_deploy:
- export WHEELS=$(ls ./dist/*.whl)
deploy:
  provider: releases
  api_key:
    secure: PvM1xbJ7k7voRFcLqppVRmPez+mKfqmML4Kjx/PA3xnNmoafGEatfvetobuLQzGhw01iJFdgkvTuWhi2ohOxYhVHT3cjGMoG2f9GH89k2w2f4lHWSkG+36PAvCBIkExMeiTOe78yBFggDZwtirKtcJSE5+f5Di6qaCowzZ9UubvFCb7YTaIgbNGNH+ZTOg0F7GGLKCV8R7MuFjnUt5k0eoKzd0TvCuIuNWl71eegFbw9TXGlOnZ+4FgIhfufMD48YDGDtZGCw5xpDMP3BQr5Oc9OH7kzkWgD3ifZMWhBSikP8wczctXEWw9vVVLje0h1vPVmKF0iRdANSSnRocmnzdUwGoVJIzgFuo0w39AHNWu1XJh06Ox/+GsmlHjM5PkEpptCje+niOuP+/V2QAQjAsH9iVvTuH4Mr2EfzDamsAN1c3JKFCUc/BhZEY4+/gq6Ng5agI4iCJgqPaqQLAy4qVuyJhDbzw3iAdyB/Bc/ksrizfx/Te+WlV+ktV2hckQMiwK64OVixrAJ2jbwK3dbCtkf2hrkiZUQfO8Qe8hfaujJp4NiiX7zl2Z4MfqLwSN5fHo36vg74fIdZ8AXU5reMywRgv5KWS1jh5HYNJhXBCwQhZIgsx3PPZAXrGn1BJVVdzEhDGjFNyGkyVgbLkUhQAC5aOrAQQTbGkTGjkEk9lg=
  file_glob: true
  file:
    - "${WHEELS}"
  skip_cleanup: true
  on:
    repo: daltonmaag/brotli
    tags: true
